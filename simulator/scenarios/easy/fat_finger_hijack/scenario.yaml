# Fat-finger BGP hijack scenario
#
# This is an intentionally boring, realistic operator mistake.
# No nation-states. No zero-days. Just one wrong digit and a bad day.

name: fat-finger-hijack
level: easy

description: >
  An operator accidentally announces a prefix they do not own due to a
  configuration error. The route propagates briefly before being
  withdrawn. Detection relies on basic origin validation, path anomalies,
  and corroborating router logs.

# Timeline is expressed in simulated seconds
# The clock starts at t=0 when the scenario begins

timeline:
  - at: 0
    action: bgp.update
    parameters:
      prefix: "203.0.113.0/24"
      as_path: [64512]
      origin_as: 64512
      next_hop: "192.0.2.1"
      attack_step: "initial_mistake"

  - at: 30
    action: router.syslog
    parameters:
      severity: info
      message: "Applied new BGP configuration"
      subsystem: config
      attack_step: "change_applied"

  - at: 90
    action: bgp.update
    parameters:
      prefix: "203.0.113.0/24"
      as_path: [64512, 64496]
      origin_as: 64512
      next_hop: "192.0.2.1"
      attack_step: "propagation"

  - at: 180
    action: router.syslog
    parameters:
      severity: warning
      message: "Unexpected route for 203.0.113.0/24 observed"
      subsystem: bgp
      attack_step: "suspicion"

  - at: 300
    action: bgp.withdraw
    parameters:
      prefix: "203.0.113.0/24"
      withdrawn_by_as: 64512
      attack_step: "rollback"
