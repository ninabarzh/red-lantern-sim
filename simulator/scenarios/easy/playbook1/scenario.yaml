id: playbook1_rpki_recon
name: "Playbook 1: RPKI Reconnaissance and ROA Creation"
description: |
  Control-plane attack preparation: RPKI reconnaissance, legitimate ROA creation,
  and baseline establishment before ROA poisoning.

  This phase establishes normality. Nothing breaks. Nothing alerts.
  The absence of noise is the success condition.

timeline:
  # === BASELINE: Target prefix operating normally ===
  - t: 0
    action: baseline_announcement
    prefix: "203.0.113.0/24"
    origin_as: 65003
    as_path: [65003]
    next_hop: "192.0.2.254"
    attack_step: "baseline"
    note: "Victim AS announces prefix normally; no RPKI enforcement events"

  # === ACTION 1.1: Quiet RPKI reconnaissance (off-router) ===
  - t: 60
    action: recon_complete
    target_prefix: "203.0.113.0/24"
    target_as: 65003
    roa_status: "not_found"
    attack_step: "reconnaissance"
    note: "Out-of-band recon confirms no ROA exists (no router-visible output)"

  # === ACTION 1.2: Legitimate ROA creation for our own prefix ===
  - t: 300
    action: roa_creation_request
    prefix: "198.51.100.0/24"
    origin_as: 64513
    max_length: 25
    registry: "RIPE"
    actor: "operator@attacker-as64513.net"
    attack_step: "establish_presence"
    note: "Request ROA creation for our own prefix"

  - t: 360
    action: roa_accepted
    prefix: "198.51.100.0/24"
    origin_as: 64513
    attack_step: "establish_presence"
    note: "ROA request accepted by RIPE (typical outcome)"

  # === ROA publication delay ===
  - t: 1500
    action: roa_published
    prefix: "198.51.100.0/24"
    origin_as: 64513
    trust_anchor: "ripe"
    attack_step: "establish_presence"
    note: "ROA published in RIPE repository"

  # === Operator verification (light, intentional) ===
  - t: 1800
    action: validator_check
    prefix: "198.51.100.0/24"
    origin_as: 64513
    validator: "routinator"
    rpki_state: "valid"
    attack_step: "establish_presence"
    note: "Validator routinator confirms ROA validity"

  - t: 1860
    action: validator_check
    prefix: "198.51.100.0/24"
    origin_as: 64513
    validator: "cloudflare"
    rpki_state: "valid"
    attack_step: "establish_presence"
    note: "Validator cloudflare confirms ROA validity"

  # === Our legitimate announcement ===
  - t: 2000
    action: baseline_announcement
    prefix: "198.51.100.0/24"
    origin_as: 64513
    as_path: [ 64513 ]
    next_hop: "192.0.2.254"
    rpki_state: "valid"
    attack_step: "establish_presence"
    note: "Our prefix announced normally, now validated via RPKI"

  # === ACTION 1.3: Baseline documentation ===
  - t: 2100
    action: baseline_documented
    target_prefix: "203.0.113.0/24"
    target_roa_status: "not_found"
    our_prefix: "198.51.100.0/24"
    our_roa_status: "valid"
    attack_step: "documentation"
    note: "Baseline documented; target unchanged, our ROA present"

  # === Waiting period ===
  - t: 2400
    action: waiting_period_complete
    days_elapsed: 7
    attack_step: "operational_cover"
    note: "Compressed 7-day waiting period completed to establish normality"

  # === Phase completion ===
  - t: 2520
    action: phase1_complete
    attack_step: "completion"
    note: "Phase 1 complete; ready for Phase 2"

  - t: 7200
    type: end_marker
