id: playbook2_roa_expansion
name: "Playbook 2: ROA scope expansion and validation mapping"
description: |
  Control-plane attack escalation: create a fraudulent ROA for a victim prefix,
  observe global RPKI validation behaviour, and establish monitoring.

  This is phase 2 of a 3-part chain targeting RPKI-dependent routing decisions.

timeline:
  # === PHASE 1 RECAP ===
  - t: 0
    action: phase1_complete
    our_prefix: "198.51.100.0/24"
    our_as: 64513
    target_prefix: "203.0.113.0/24"
    target_as: 65003
    target_roa_status: "not_found"
    attack_step: "baseline"
    note: "Legitimate RPKI presence established earlier; waiting period elapsed"

  # === ACTION 2.1: Fraudulent ROA creation ===

  - t: 60
    action: credential_use
    user: "admin@victim-network.net"
    source_ip: "185.220.101.45"
    system: "rir_portal"
    attack_step: "credential_compromise"
    note: "Use of compromised maintainer credentials; appears as legitimate operator activity"

  - t: 120
    action: roa_creation
    prefix: "203.0.113.0/24"
    origin_as: 64513
    max_length: 25
    registry: "ARIN"
    actor: "admin@victim-network.net"
    attack_step: "roa_poisoning"
    note: "ROA created under compromised account authority"

  # Automated approval is not a separate step in reality; acting as maintainer implies consent
  # - action: rir_validation_check
  #   validation_result: "approved"

  # === ROA publication and propagation ===

  - t: 2400
    action: roa_published
    prefix: "203.0.113.0/24"
    origin_as: 64513
    max_length: 25
    trust_anchor: "arin"
    attack_step: "roa_poisoning"
    note: "ROA published to ARIN repository and becomes fetchable by validators"

  - t: 2700
    action: validator_sync
    validator: "routinator"
    prefix: "203.0.113.0/24"
    origin_as: 64513
    rpki_state: "valid"
    attack_step: "roa_poisoning"
    note: "Validator now considers AS64513 a valid origin for the prefix"

  - t: 2760
    action: validator_sync
    validator: "cloudflare"
    prefix: "203.0.113.0/24"
    origin_as: 64513
    rpki_state: "valid"
    attack_step: "roa_poisoning"

  - t: 2820
    action: validator_sync
    validator: "ripe"
    prefix: "203.0.113.0/24"
    origin_as: 64513
    rpki_state: "valid"
    attack_step: "roa_poisoning"

  # === Coexisting ROAs (not validator confusion) ===

  - t: 2880
    action: roa_set_state
    prefix: "203.0.113.0/24"
    origins_present: [65003, 64513]
    attack_step: "roa_poisoning"
    note: "Multiple ROAs exist; announcements will be evaluated per-origin"

  # === ACTION 2.2: Validation behaviour mapping ===

  - t: 3000
    action: observation_start
    focus: "rpki_enforcement"
    attack_step: "validation_mapping"
    note: "Begin observing routing outcomes for deliberately invalid announcements"

  - t: 3060
    action: test_announcement
    prefix: "198.51.100.0/24"
    origin_as: 64514
    region: "AMER"
    observed_result: "filtered_by_some_peers"
    attack_step: "validation_mapping"

  - t: 3120
    action: test_announcement
    prefix: "198.51.100.0/24"
    origin_as: 64514
    region: "EMEA"
    observed_result: "widely_propagated"
    attack_step: "validation_mapping"

  - t: 3180
    action: test_announcement
    prefix: "198.51.100.0/24"
    origin_as: 64514
    region: "APAC"
    observed_result: "inconsistent"
    attack_step: "validation_mapping"

  - t: 3240
    action: test_withdrawal
    prefix: "198.51.100.0/24"
    origin_as: 64514
    attack_step: "validation_mapping"

  - t: 3300
    action: validation_map_complete
    qualitative_results:
      AMER: "partial enforcement observed"
      EMEA: "low enforcement observed"
      APAC: "mixed enforcement observed"
    target_region: "EMEA"
    attack_step: "validation_mapping"
    note: "Region selection based on observed acceptance patterns"

  # === ACTION 2.3: Monitoring ===

  - t: 3420
    action: monitoring_deployed
    target_prefix: "203.0.113.0/24"
    check_interval: 300
    alerts:
      - roa_removed
      - roa_added
      - validation_state_change
    attack_step: "monitoring"

  - t: 3480
    action: monitoring_baseline
    prefix: "203.0.113.0/24"
    roa_count: 2
    our_roa_present: true
    attack_step: "monitoring"

  # === Stability wait ===

  - t: 4080
    action: stability_check
    prefix: "203.0.113.0/24"
    observation_window_hours: 48
    changes_detected: false
    attack_step: "stability_wait"
    note: "No defensive response observed during monitoring window"

  # === PHASE 2 COMPLETE ===

  - t: 4200
    action: phase2_complete
    roa_status: "stable"
    validation_mapping: "complete"
    monitoring_status: "active"
    target_region: "EMEA"
    attack_step: "completion"
    note: "Preconditions met for Phase 3 execution"

  - t: 7200
    type: end_marker
