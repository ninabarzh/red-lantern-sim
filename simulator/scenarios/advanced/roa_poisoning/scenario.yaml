id: roa-poisoning
description: >
  Control-plane attack where attacker compromises routing policy
  management, manipulates RPKI ROAs, and uses operational cover
  to mask malicious intent. This breaks "but we have RPKI" complacency.

timeline:
  - t: 0
    action: start

  - t: 10
    action: baseline_rpki
    prefix: 203.0.113.0/24
    origin_as: 65001
    rpki_state: valid
    note: "Normal state: valid ROA exists"

  - t: 120
    action: suspicious_login
    user: admin_backup
    source_ip: 185.220.101.45
    location: RU
    system: routing_portal
    note: "Compromised credentials, unusual location"

  - t: 240
    action: roa_deleted
    prefix: 203.0.113.0/24
    origin_as: 65001
    actor: admin_backup
    note: "Legitimate ROA deleted without authorisation"

  - t: 245
    action: rpki_state_flip
    prefix: 203.0.113.0/24
    origin_as: 65001
    previous_state: valid
    current_state: not_found
    note: "RPKI validation state changes to not-found"

  - t: 300
    action: policy_commit
    user: admin_backup
    commit_hash: a1b2c3d4
    message: "Update peering policies"
    files_changed:
      - bgp/policies/peer-filters.conf
    note: "Unauthorised BGP policy modification"

  - t: 360
    action: announce_with_roa
    prefix: 203.0.113.0/24
    attacker_as: 65004
    rpki_state: valid
    note: "Attacker announces with their own ROA"

  - t: 365
    action: victim_route_rejected
    prefix: 203.0.113.0/24
    victim_as: 65001
    reason: rpki_invalid
    note: "Victim's route now rejected by RPKI-enforcing peers"

  - t: 370
    action: blackhole_community
    prefix: 203.0.113.0/24
    community: "65535:666"
    attacker_as: 65004
    note: "Blackhole community tagged, causing widespread drops"

  - t: 400
    action: coordinated_flap
    prefixes:
      - 203.0.113.0/26
      - 203.0.113.64/26
      - 203.0.113.128/26
      - 203.0.113.192/26
    flap_count: 12
    note: "Coordinated flapping to mask attack with noise"

  - t: 600
    action: roa_restored
    prefix: 203.0.113.0/24
    origin_as: 65001
    actor: admin_backup
    note: "ROA restored after exploitation"

  - t: 605
    action: logout
    user: admin_backup
    note: "Attacker disconnects"
