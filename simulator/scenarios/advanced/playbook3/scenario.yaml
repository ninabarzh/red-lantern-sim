id: playbook3_hijack_execution
name: "Playbook 3: Prefix Hijacking with RPKI Validation Cover"
description: |
  Control-plane attack execution: Execute sub-prefix hijack that validates as
  RPKI VALID due to fraudulent ROA created in phase 2.

  This demonstrates the payoff of control-plane poisoning:
  validators endorse the attack, routers enforce it, traffic follows.

timeline:
  # === PHASE 2 RECAP ===
  - t: 0
    action: phase2_complete
    fraudulent_roa_prefix: "203.0.113.0/24"
    fraudulent_roa_origin: 64513
    fraudulent_roa_maxlength: 25
    attack_step: "baseline"
    note: "Phase 2 complete: fraudulent ROA for 203.0.113.0/24 with maxLength 25 is now active"

  # === ACTION 3.1: Hijack ===
  - t: 60
    action: hijack_announcement
    prefix: "203.0.113.128/25"
    as_path: [65001, 64513]
    origin_as: 64513
    next_hop: "198.51.100.254"
    peer_ip: "198.51.100.1"
    peer_as: 65001
    rpki_state: "valid"
    attack_step: "hijack_announcement"
    note: "Announcing hijack prefix 203.0.113.128/25 via AS64513 - this will validate as RPKI VALID due to fraudulent ROA"

  # Validators all say YES
  - t: 120
    action: rpki_validation_check
    prefix: "203.0.113.128/25"
    origin_as: 64513
    validation_result: "valid"
    attack_step: "hijack_announcement"
    note: "RPKI validators confirm hijack is VALID - attack traffic is now authorized by RPKI"

  # === The cruelty starts here ===
  - t: 180
    action: best_path_change
    prefix: "203.0.113.128/25"
    old_path: [65002, 64513]
    new_path: [65001, 64513]
    reason: "more-specific prefix"
    attack_step: "impact"
    note: "BGP best path changes: routers prefer /25 hijack over legitimate /24 due to longest prefix match"

  - t: 240
    action: traffic_anomaly
    prefix: "203.0.113.128/25"
    region: "APAC"
    rtt_ms: 240
    baseline_ms: 35
    packet_loss_pct: 0.8
    attack_step: "impact"
    note: "Traffic impact begins: APAC users experience increased latency (240ms vs 35ms baseline)"

  - t: 300
    action: traffic_anomaly
    prefix: "203.0.113.128/25"
    region: "APAC"
    rtt_ms: 310
    baseline_ms: 35
    packet_loss_pct: 1.4
    attack_step: "impact"
    note: "Traffic impact worsens: packet loss increases to 1.4% as hijack traffic load grows"

  # === Sustained operation ===
  - t: 900
    action: monitoring_check
    roa_status: "still_present"
    bgp_announcement: "stable"
    attack_step: "operational_monitoring"
    note: "15 minutes into attack: fraudulent ROA still present, hijack announcement stable"

  - t: 3600
    action: monitoring_check
    roa_status: "still_present"
    bgp_announcement: "stable"
    attack_step: "operational_monitoring"
    note: "1 hour into attack: operation continues undetected, RPKI validation still shows VALID"

  # === Withdrawal ===
  - t: 5520
    action: withdrawal_announcement
    prefix: "203.0.113.128/25"
    origin_as: 64513
    attack_step: "withdrawal"
    note: "Initiating clean withdrawal: announcing BGP WITHDRAW for hijack prefix"

  - t: 5580
    action: withdrawal_propagation
    prefix: "203.0.113.128/25"
    peers_removed: [65001, 65002]
    attack_step: "withdrawal"
    note: "Withdrawal propagation begins: first peers remove hijack route"

  - t: 5600
    action: withdrawal_propagation
    prefix: "203.0.113.128/25"
    peers_removed: [65003, 65004, 65005]
    attack_step: "withdrawal"
    note: "Withdrawal continues: additional peers remove hijack route"

  - t: 5640
    action: traffic_reconvergence
    prefix: "203.0.113.128/25"
    via_as: 65003
    reconvergence_time_seconds: 45
    attack_step: "withdrawal"
    note: "Traffic reconvergence: legitimate path via AS65003 restored after 45 seconds"

  - t: 5700
    action: victim_service_restored
    prefix: "203.0.113.0/24"
    attack_step: "withdrawal"
    note: "Victim service restored: all traffic now flowing via legitimate /24 announcement"

  - t: 5880
    action: phase3_complete
    rpki_validation_status: "valid_throughout"
    control_plane_attack_confirmed: true
    withdrawal_clean: true
    attack_step: "completion"
    note: "Phase 3 complete: attack executed successfully with RPKI VALID status throughout, clean withdrawal accomplished"

  - t: 7200
    type: end_marker
    note: "Scenario complete"
